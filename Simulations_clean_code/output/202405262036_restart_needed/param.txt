sol = solve(prob, Tsit5(); isoutofdomain=stepcheck, dt=0.001, dtmin=1e-8, abstol=1e-5, reltol=1e-6, save_everystep=false,
        callback=callback_func)


Doestn't converge after 3 cycles, need restart 